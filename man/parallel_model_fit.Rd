% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parallel_model_comparsion.R
\name{parallel_model_fit}
\alias{parallel_model_fit}
\title{Fit many models (optionally compare them) in parallel}
\usage{
parallel_model_fit(
  fun,
  loop_args,
  form_fun = NULL,
  model_fun = NULL,
  prior_fun = NULL,
  args,
  model_name = "Model",
  model_path,
  sampler_args = list(cores = 1, repetition = 10, maxiter = 1000),
  sample_path = NULL,
  sample_check = TRUE,
  maxCore = NULL
)
}
\arguments{
\item{fun}{Function. A \strong{model fitting function} (supports \code{brms} and \code{bmm} models).}

\item{loop_args}{List. List of arguments whose elements define the grid over which the models are built (e.g., different formulas, priors, or data subsets). The values are passed to \code{form_fun}, \code{model_fun}, or \code{prior_fun}.}

\item{form_fun}{Function. A function to generate model formulas given \code{loop_args} (default is \code{NULL}).}

\item{model_fun}{Function. A function to generate models given \code{loop_args} (supports \code{bmm} models only, default is \code{NULL}).}

\item{prior_fun}{Function. A function to generate prior distributions given \code{loop_args} (default is \code{NULL}).}

\item{args}{List. List of arguments always passed to the model-fitting function (i.e., \code{fun}) such as \code{data}, \code{iter}, \code{chains}, …}

\item{model_name}{Character. The base name for models (default: \code{"Model"}).}

\item{model_path}{Character. The directory to store model `.rds``files.}

\item{sampler_args}{List or NULL. Arguments for \code{bridge_sampler} (default: \code{list(cores = 1, repetition = 10, maxiter = 1000)}). If \code{NULL}, bridge sampling is skipped.}

\item{sample_path}{Character. The directory to store bridge-sampling results. Defaults to NULL}

\item{sample_check}{Logical. If \code{TRUE}, checks whether samples exist before running (default: \code{TRUE}).}

\item{maxCore}{Integer. The maximum number of cores to use (default is system limit).}
}
\value{
Model files and optional sample objects are written to \code{model_path} and \code{sample_path}.
}
\description{
Fits a grid of models in parallel (or in sequence) and, if
\code{sampler_args} is supplied, runs \code{bridge_sampler()} on each fitted
model and stores the results for later Bayes‑factor computation.
}
\examples{
\dontrun{
grid  <- list(prior_sd = c(1, 2, 3))
parallel_model_fit(
  fun        = brms::brm,
  loop_args  = grid,
  prior_fun  = function(prior_sd) set_prior(paste0("normal(0,", prior_sd, ")")),
  args       = list(formula = bf(y ~ x), data = df, iter = 2000, chains = 4),
  model_path = "./models/"
)
}

}
